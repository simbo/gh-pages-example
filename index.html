<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>GitHub Pages Example</title><meta property="og:type" content="article"><meta property="og:title" content="GitHub Pages Example"><meta property="og:site_name" content="Simon Lepel's GitHub Pages"><meta property="og:description" content="An example project and tutorial for creating and deploying GitHub Pages projects using custom build tools and Travis CI."><meta property="og:url" content="https://simbo.github.io/gh-pages-example"><meta property="og:image" content="https://simbo.github.io/gh-pages-example/images/article-cover.png"><meta property="og:image:width" content="600"><meta property="og:image:height" content="314"><meta property="article:published_time" content="2018-05-23"><meta property="article:author" content="Simon Lepel"><link href="styles/main.94b1ae4a38c083fea561.css" rel="stylesheet"></head><body><article><div class="github-ribbon"><a href="https://github.com/simbo/gh-pages-example"><span></span></a></div><h1 id="github-pages-example">GitHub Pages Example</h1><div class="intro"><p>An example project and tutorial for creating and deploying <em>GitHub Pages</em> projects using custom build tools and <em>Travis CI</em>.</p></div><div class="author">Published by <a href="https://github.com/simbo" rel="author">Simon Lepel</a> in May 2018</div><hr><ul><li><a href="#about-this-project">About this project</a><ul><li><a href="#types-of-github-pages">Types of GitHub Pages</a></li></ul></li><li><a href="#assumed-preconditions">Assumed preconditions</a></li><li><a href="#deployment-strategy">Deployment strategy</a><ul><li><a href="#deploying-using-travis-ci">Deploying using Travis CI</a></li><li><a href="#deploying-manually">Deploying manually</a></li></ul></li><li><a href="#good-to-know">Good to know</a></li><li><a href="#feedback">Feedback</a></li></ul><h2 id="tl-dr">TL;DR</h2><ul><li><p>push your pages project sources to <code>master</code> branch while generated files are added to <code>.gitignore</code></p></li><li><p>enable Travis CI using <a href="https://docs.travis-ci.com/user/deployment/pages/">pages deployment</a> to build from <code>master</code> branch and push only generated files to <code>gh-pages</code> branch (see final <a href="#deployment-config"><code>.travis.yml</code></a>)</p></li><li><p><a href="https://github.com/settings/tokens">GitHub personal access token</a> with access scope <code>public_repo</code> is required for pushing from Travis CI</p></li></ul><h2 id="about-this-project">About this project</h2><p>This example project demonstrates a clean and convenient strategy to create and deploy <em>GitHub Pages</em> projects.</p><p>It focuses on setups, where pages are generated by a custom build tool (like webpack, gulp or whatever) and not automatically generated by GitHub using Jekyll or markdown. Although those type of projects could also benefit from shown workflows.</p><p>If you are not familiar with <em>GitHub Pages</em>‘ core concepts, you may want to head over to the <a href="https://pages.github.com/">official documentation</a> first.</p><h3 id="types-of-github-pages">Types of GitHub Pages</h3><p>There are two types of GitHub Pages: <em>project pages</em> and <em>user or organization pages</em>.</p><p>Both offer the same features, while there are some important differences:</p><ul><li><em>Project Pages</em> (i.e. <code>your-username.github.io/your-project</code>)<br>…for creating pages for your project.<br>can be published from:<ul><li><code>gh-pages</code> branch</li><li><code>master</code> branch</li><li><code>master</code> branch <code>docs/</code> folder</li></ul></li></ul><ul><li><em>User/Organization Pages</em> (i.e. <code>your-username.github.io</code>)<br>…for creating your personal user pages or organization pages.<br>can <em>only</em> be published from <code>master</code> branch</li></ul><div class="alert--info"><p>This document focuses on <em>project pages</em> that are published from a <code>gh-pages</code> branch, as this is <em>imho</em> the most usual and convenient usecase.</p></div><p>I suppose that, after reading this tutorial, you will be able to change configuration settings according to your needs to publish your <em>user pages</em> or whatever you want to do.</p><h2 id="assumed-preconditions">Assumed preconditions</h2><p>You have just created your new website project and your project root looks somehow like this:</p><pre><code class="language-text">./
├─ dist/          # generated pages
├─ src/           # sources and templates
├─ .gitignore     # `dist/` folder is ignored
├─ package.json   # project metadata and tasks
└─ README.md      # project information</code></pre><p>The <code>dist/</code> folder should be added to <code>.gitignore</code> as we do not want to commit generated files to our source branches.</p><p>Everything else should be committed to your git repository’s <code>master</code> branch and pushed to GitHub.</p><h2 id="deployment-strategy">Deployment strategy</h2><p>The concept is simple:</p><div class="alert--info"><p>While your generated <code>dist/</code> folder is ignored for the <code>master</code> branch, you have another branch <code>gh-pages</code> that only contains the generated contents of <code>dist/</code>, which will be automatically published at your GitHub pages URL.</p></div><p>This is easy to achieve using a CI/CD service like <em>Travis CI</em> but can also be done manually.</p><h3 id="deploying-using-travis-ci">Deploying using Travis CI</h3><h4 id="preparations">Preparations</h4><h5 id="enable-travis-ci-support">Enable Travis CI support</h5><p>If not done already, register at <a href="https://travis-ci.org/">Travis CI</a> using your GitHub account and install the <a href="https://github.com/travis-ci/travis.rb">travis client</a> on your machine.</p><p>Enable Travis support for your project by running <code>travis init</code> in your project root. When asked for main language, choose what fits your needs (i.e. <code>node</code>).</p><p>Afterwards, there should be a fresh generated <code>.travis.yml</code> in your project root.</p><h5 id="github-personal-access-token">GitHub personal access token</h5><p>Go to GitHub and get a <a href="https://github.com/settings/tokens">personal access token</a>, so Travis will be authorized to push changes back to GitHub. Give it a useful description like <code>my-project travis deploy</code> and select <code>public_repo</code> as access scope.</p><p>After generating the token, encrypt it and add it to your Travis config:</p><pre><code class="language-bash">travis encrypt GITHUB_TOKEN=your-personal-access-token --add</code></pre><h5 id="deployment-config">Deployment config</h5><p>Travis offers the <a href="https://docs.travis-ci.com/user/deployment/pages/">GitHub Pages deployment provider</a>, which fullfills all our needs automagically.</p><p>With deployment options, your final <code>.travis.yml</code> should look like this:</p><pre><code class="language-yaml">language: node_js
node_js:
- &#39;8.11.*&#39;

env:
  global:
    secure: PDS4pIbrZhQaB…  # encrypted github token

script:
- npm run build             # build script

deploy:
  provider: pages
  github-token: $GITHUB_TOKEN
  on:
    branch: master          # trigger deploys only from master branch
  local-dir: dist           # path to generated pages
  target-branch: gh-pages   # target branch for deploy
  skip-cleanup: true        # keep generated files from build script
  keep-history: true        # keep git history in gh-pages branch</code></pre><p>If not already existing, the <code>gh-pages</code> branch will be automatically created on the first deploy.</p><p>Afterwards, you can enable <em>GitHub Pages</em> support in your repository settings on GitHub. Make sure to set the build source to <code>gh-pages</code> branch.</p><p><em>You’re done!</em></p><h4 id="triggering-deploys">Triggering deploys</h4><p>Every pushed commit to <code>master</code> should now automatically trigger a build and push updates to <code>gh-pages</code>, which will be published at the respective URL.</p><h3 id="deploying-manually">Deploying manually</h3><div class="alert--warning"><p>I do not recommend to use manual deployment as a common strategy. Although it seems simple, it’s prone to human error. Nevertheless, it’s good to know…</p></div><p>We’re assuming the same preconditions as for deploying with Travis: <code>dist/</code> folder is ignored while everything else is pushed to <code>master</code> with no current changes in the working tree.</p><h4 id="preparations-for-manual-deploy-workflow">Preparations for manual deploy workflow</h4><h5 id="create-gh-pages-branch">Create <code>gh-pages</code> branch</h5><p>You can skip branch creation if you already have a branch <code>gh-pages</code> on your GitHub remote.</p><pre><code class="language-bash"># create a new orphan branch `gh-pages` and clear its working tree
git checkout --orphan gh-pages
git rm -rf .

# create an `index.html` and commit it
echo &quot;Hello World&quot; &gt; index.html
git add index.html
git commit -m &quot;initial content&quot;

# push `gh-pages` branch to github
git push origin gh-pages

# switch back to `master` branch and delete `gh-pages` locally
git checkout master
git branch -d gh-pages</code></pre><p>Afterwards, you can enable <em>GitHub Pages</em> support in your repository settings on GitHub. Make sure to set the build source to <code>gh-pages</code> branch.</p><h5 id="clone-gh-pages-to-dist-">Clone <code>gh-pages</code> to <code>dist/</code></h5><p>Now clone the <code>gh-pages</code> branch to the <code>dist/</code> folder inside of your repo. This way your build script will generate files directly into <code>gh-pages</code>.</p><pre><code class="language-bash"># remove generated dist folder if existing
rm -rf dist
# clone only `gh-pages` to `dist/`
git clone git@github.com:USER/PROJECT.git --branch gh-pages --single-branch dist</code></pre><h4 id="manual-deployment-steps">Manual deployment steps</h4><pre><code class="language-bash"># run build script
npm run build
# go to `dist/` to commit and push generated changes
cd dist
git add -r .
git commit -m &quot;update content&quot;
git push origin gh-pages</code></pre><p>When using manual deployment like this, make sure that your build script doesn’t touch the repository inside of <code>dist/</code>. You may want to build a little script for the deployment steps (or better <a href="#deploying-using-travis-ci">use Travis CI for deployment</a> directly).</p><h2 id="good-to-know">Good to know</h2><ul><li><p><code>index.html</code> vs. <code>README.md</code></p><p>There will be a conflict if you have both of these in your <code>gh-pages</code> root, as GitHub seems indecisive which one of them to use per default…</p></li></ul><h2 id="feedback">Feedback</h2><p>Feel free to use <a href="https://github.com/simbo/gh-pages-example/issues">project issues</a> for discussion and comments.</p></article><script type="text/javascript" src="scripts/manifest.05d5f6a7cec310a18ce4.js"></script><script type="text/javascript" src="scripts/main.a13a69801713e9d57826.js"></script></body></html>